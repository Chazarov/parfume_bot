## Проект:

**Название:**  malling_core

**Ответственный:** Захаров Андрей Максимович

## Сервис:

* **Статус:**  Разрабатываемый

* **Доп. Информация о сервисе:**



## Описание сервиса:
Сервис предназначен для отправки рассылок через мессенджеры (WhatsApp и Telegram). Реализует обработку запросов API для интеграции с внешними сервисами, поддерживает очереди на основе Redis и управляется через Celery.

## Размещение компонента
| Правило | Название | Значение |
|--|--|--|
| **1** | Параметры конфигурации должны конфигурироваться через переменные окружения	 | Да |
| **2** | Пароли передаются аналогично через переменные окружения. Хранить пароли в файлах внутри кода запрещено.	 | Да |
| **3** | Файлы конфигурации (что сложно передать через переменные окружения) могут быть переданы командой DevOps внутрь контейнера как простой файл.	 | Да |
| **4** | Sensitive файлы (например ssh ключи что сложно передать через переменные окружения) могут передавать внутрь контейнера как просто файлы	 | Не используется |
| **5** | Приложение обязано настроить healthcheck (HTTP метод GET)	 | Да |
| **6** | Если сервис предоставляет REST API для других сервисов - то они документируются в Swagger | Не используется |
| **7** | Для веб приложений использовать порт 80	 | Не используется |
| **8** | Приложения по возможности писать горизонтально масштаблируемыми (stateless)	 | Да |
| **9** | Если требуется, чтобы API сервиса было доступно из вне	 | Да |
| **10** | Сервисы пишут логи в консоль (stdout/err). Логи структурированном JSON формате	 | `stdout` `json` |

---
## Сборка образа
Используется Dockerfile. Дополнительных действий не требуется, иначе описать в этом пункте

---
# **Запуск образа**

## Запуск приложения
**Способ запуска приложения:** Docker, Kubernetes. На сервере находится в Kubernetes.

**Команда для запуска сервиса:**  Указать команду для запуска контейнера. Если контейнеров несколько - указать по каждому.

  

## Требуемые ресурсы
**Request** 
- CPU: 500m
- RAM: 512MiB

**Limits**
- CPU: 1000m
- RAM: 1024MiB

  

## Конфигурация и секреты
| Название параметра | Описание | Пример | Kubernetes Secret | Обязательность |
|--|--|--|--|--|
| **`DB_PSQL_URL`** | JDBC URL для подключение к БД | 	`jdbc:postgresql://localhost:port/db_name` | Да / Нет | Да / Нет |
| **`DB_PSQL_USER`** | Имя пользователя для подключения к БД	 | `user` | Да / Нет | Да / Нет |
| **`DB_PSQL_PASSWORD`** | Пароль для подключения к БД	 | `password` | Да / Нет | Да / Нет |


| Обязательность | Источник | Точка монтирования | Описание | Расположение файла (опционально) |
|--|--|--|--|--|
| Да / Нет |  |  |  |  |


---
## Конфигурация и доступ работы с таблицами БД
| БД | Адрес | Схема | Пользователь | Таблица | Уровень доступа |
|--|--|--|--|--|--|
|  |  |  |  |  |  |


---
## Описание API
| Метод | Endpoint |  Параметры | Описание |
|--|--|--|--|
| GET / POST / PUT |  | Указать возможные передаваемые параметры и способ их передачи (хэдер, ключи) | Описать для чего этот метод |
|  |  |  | Если у приложения есть полный и достаточный swagger необходимо указать ссылку на него, остальное пропускаем |

---
## Мониторинг и сбор статистики
| Метод | Endpoint | Описание |
|--|--|--|
| **`GET`** | `/healtz` | сведения о работоспособности приложения |

---
## Взаимодействие со смежными сервисами
Список внешних/внутренних сервисов с которыми взаимодействует или связан данный сервис.

| Сервис | Тип расположения <br> (внешний/внутренний) | Адрес/Порт | Конфигурационные параметры связанные с сервисом |
|--|--|--|--|
| Redis | Внутренний |  |  |
| WhatsApp API | Внешний |  |  |
| Telegram API | Внешний |  |  |

---
## **Дополнения**
На данный момент сервис разрабатывается, возможны изменения в API и конфигурациях.